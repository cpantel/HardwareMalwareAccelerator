/*
 * main.c
 *
 *  Created on: Nov 6, 2020
 *      Author: carlos
 */

#include <stdio.h>
#include "xil_printf.h"
#include "xil_io.h"

#define BaseAddress    0x43c00000
#define REG_KEY        0
#define REG_CLEARTEXT  4
#define REG_CIPHERTEXT 8
#define REG_COUNT      12

int main() {
  u32 key;
  u32 clearText;
  u32 cipherText;
  u32 count;

  xil_printf("Accelerator\n\r");

  Xil_Out32(BaseAddress + REG_KEY, 3);

  for (u32 i=0; i< 255; ++i) {
        Xil_Out32(BaseAddress + REG_CLEARTEXT, i);

    key        = Xil_In32(BaseAddress + REG_KEY);
    clearText  = Xil_In32(BaseAddress + REG_CLEARTEXT);
    cipherText = Xil_In32(BaseAddress + REG_CIPHERTEXT);
    count      = Xil_In32(BaseAddress + REG_COUNT);

    xil_printf("i          : 0x%08x\n", i );
    xil_printf("key        : 0x%08x\n", key );
    xil_printf("clear text : 0x%08x\n", clearText );
    xil_printf("cipher text: 0x%08x\n", cipherText );
    xil_printf("count      : 0x%08x\n", count );

    sleep(5);
  }
  return 0;
}

